-# coding: UTF-8
!!!  
%html  
  %head  
  %meta{charset: "utf-8"}
  %script{type:"text/javascript",src:"/javascripts/jquery-1.7.2.min.js"}
  %script{type:"text/javascript",src:"/javascripts/jquery-ui-1.8.22.custom.min.js"}
  %script{type:"text/javascript",src:"/javascripts/application.js"}

  %link{href:"/css/styles.css", rel:"stylesheet"}

  :javascript
    $(function() {
      var eventSource = new EventSource('/stream');

      eventSource.addEventListener('open', function() {
        console.log("Connection opened");
    }, false);

    // An event without a type came in
    eventSource.addEventListener('message', function(event) {
        var stockData = event.data;
        console.log("Server says:"+ stockData);
    }, false);
    eventSource.addEventListener('delete', function(event) {
        var stockData = event.data;
        console.log("Server delete says:"+ stockData);
    }, false);
    eventSource.addEventListener('update', function(event) {
        var stockData = event.data;
        console.log("Server update says:"+ stockData);
    }, false);
    eventSource.addEventListener('create', function(event) {
        var stockData = event.data;
        console.log("Server create says:"+ stockData);
    }, false);
    eventSource.addEventListener('error', function(e) {
      if (e.eventPhase == EventSource.CLOSED) {
        console.log("Connection closed");
      }
    }, false);
    });

  %title Электронное табло караоке
  %body  
    #content
      %div{:id => 'table-begins'}
        %table{:class => "center", :id => "karaoke"}
          %thead
            %tr
              %th{:class => "number_column"} #
              %th{:class => "status_column"}
              %th{:class => "table_column"} СТОЛИК
              %th{:class => "song_column"} ПЕСНЯ
          %tbody
            %tr
              %td 1
              %td 2
              %td 3
              %td 4
            %tr
              %td 1
              %td 2
              %td 3
              %td 4
            %tr
              %td 1
              %td 2
              %td 3
              %td 4
            %tr
              %td 1
              %td 2
              %td 3
              %td 4
            %tr
              %td 1
              %td 2
              %td 3
              %td 4
            %tr
              %td 1
              %td 2
              %td 3
              %td 4
            %tr
              %td 1
              %td 2
              %td 3
              %td 4
            %tr
              %td 1
              %td 2
              %td 3
              %td 4
            %tr
              %td 1
              %td 2
              %td 3
              %td 4
            %tr
              %td 1
              %td 2
              %td 3
              %td 4
      %div{:id => "logo"}   
        %img{:src => "/images/logos/logo_big.png", :width =>"25%" , :height =>"20%",:class => "bottom-right"} 
    :javascript
      update();
